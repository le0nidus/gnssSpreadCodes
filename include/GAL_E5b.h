#include "GAL_E5.h"

constexpr int GALILEO_E5b_PRIMARY_TAPS_G1 = 064021 >> 1;
constexpr int GALILEO_E5bI_PRIMARY_TAPS_G2 = 051445 >> 1;
constexpr int GALILEO_E5bQ_PRIMARY_TAPS_G2 = 043143 >> 1;
class GAL_E5b : public GAL_E5{
public:
    GAL_E5b() {}

    void generatePrimaryE5bI(int prn) {
        if (!checkValidPRN(prn))
            return; //BAD PRN so we don't create it
        generatePrimary(prn, E5BI_g2_init[prn - 1], GALILEO_E5b_PRIMARY_TAPS_G1, GALILEO_E5bI_PRIMARY_TAPS_G2);
        return;
    }
    
    void generatePrimaryE5bQ(int prn) {
        if (!checkValidPRN(prn))
            return; //BAD PRN so we don't create it
        generatePrimary(prn, E5BQ_g2_init[prn - 1], GALILEO_E5b_PRIMARY_TAPS_G1, GALILEO_E5bQ_PRIMARY_TAPS_G2);
        return;
    }

    void generateSecondaryE5bQ(int prn) {
        if (!checkValidPRN(prn))
            return; //BAD PRN so we don't create it
        generateCodeFromString(secondaryE5bQ[prn - 1]);
        return;
    }

    void generateSecondaryE5bI(int prn) {
        if (!checkValidPRN(prn))
            return; //BAD PRN so we don't create it
        prn_code.clear();
        prn_code = E5bI_secondary;
        return;
    }
    

private:

    std::string getConstellationName() override { return "Galileo E5b"; }

    const std::vector<int> E5bI_secondary = { 1, 1, 1, 0 }; // 0xE = 0b1110
    
    const int E5BI_g2_init[GALILEO_E5_NUMBER_OF_CODES] = {
        007220, 026047, 000252, 017166, 014161, 002540, 001537, 026023,
        001725, 020637, 002364, 027731, 030640, 034174, 006464, 007676,
        032231, 010353, 000755, 026077, 011644, 011537, 035115, 020452,
        034645, 025664, 021403, 032253, 002337, 030777, 027122, 022377,
        036175, 033075, 033151, 013134, 007433, 010216, 035466, 002533,
        005351, 030121, 014010, 032576, 030326, 037433, 026022, 035770,
        006670, 012017
    };
    
    const int E5BQ_g2_init[GALILEO_E5_NUMBER_OF_CODES] = {
        003331, 006143, 025322, 023371, 000413, 036235, 017750, 004745,
        013005, 037140, 030155, 020237, 003461, 031662, 027146, 005547,
        002456, 030013, 000322, 010761, 026767, 036004, 030713, 007662,
        021610, 020134, 011262, 010706, 034143, 011051, 025460, 017665,
        032354, 021230, 020146, 011362, 037246, 016344, 015034, 025471,
        025646, 022157, 004336, 016356, 004075, 002626, 011706, 037011,
        027041, 031024
    };

    const std::string secondaryE5bQ[GALILEO_E5_NUMBER_OF_CODES] = { // CS100_51 - CS100_100
        "CFF914EE3C6126A49FD5E5C94", "FC317C9A9BF8C6038B5CADAB3",
        "A2EAD74B6F9866E414393F239", "72F2B1180FA6B802CB84DF997",
        "13E3AE93BC52391D09E84A982", "77C04202B91B22C6D3469768E",
        "FEBC592DD7C69AB103D0BB29C", "0B494077E7C66FB6C51942A77",
        "DD0E321837A3D52169B7B577C", "43DEA90EA6C483E7990C3223F",
        "0366AB33F0167B6FA979DAE18", "99CCBBFAB1242CBE31E1BD52D",
        "A3466923CEFDF451EC0FCED22", "1A5271F22A6F9A8D76E79B7F0",
        "3204A6BB91B49D1A2D3857960", "32F83ADD43B599CBFB8628E5B",
        "3871FB0D89DB77553EB613CC1", "6A3CBDFF2D64D17E02773C645",
        "2BCD09889A1D7FC219F2EDE3B", "3E49467F4D4280B9942CD6F8C",
        "658E336DCFD9809F86D54A501", "ED4284F345170CF77268C8584",
        "29ECCE910D832CAF15E3DF5D1", "456CCF7FE9353D50E87A708FA",
        "FB757CC9E18CBC02BF1B84B9A", "5686229A8D98224BC426BC7FC",
        "700A2D325EA14C4B7B7AA8338", "1210A330B4D3B507D854CBA3F",
        "438EE410BD2F7DBCDD85565BA", "4B9764CC455AE1F61F7DA432B",
        "BF1F45FDDA3594ACF3C4CC806", "DA425440FE8F6E2C11B8EC1A4",
        "EE2C8057A7C16999AFA33FED1", "2C8BD7D8395C61DFA96243491",
        "391E4BB6BC43E98150CDDCADA", "399F72A9EADB42C90C3ECF7F0",
        "93031FDEA588F88E83951270C", "BA8061462D873705E95D5CB37",
        "D24188F88544EB121E963FD34", "D5F6A8BB081D8F383825A4DCA",
        "0FA4A205F0D76088D08EAF267", "272E909FAEBC65215E263E258",
        "3370F35A674922828465FC816", "54EF96116D4A0C8DB0E07101F",
        "DE347C7B27FADC48EF1826A2B", "01B16ECA6FC343AE08C5B8944",
        "1854DB743500EE94D8FC768ED", "28E40C684C87370CD0597FAB4",
        "5E42C19717093353BCAAF4033", "64310BAD8EB5B36E38646AF01"
        };
   

};